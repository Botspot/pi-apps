#!/bin/bash

DIRECTORY="$(dirname "$(dirname "$( cd "$(dirname "$0")" >/dev/null 2>&1 ; pwd -P )")")"

function error {
  echo -e "\\e[91m$1\\e[39m"
  exit 1
}

gio trash ~/discord-electron > /dev/null
rm -f ~/.local/share/applications/discord.desktop > /dev/null

echo "Downloading latest arm64 release..."
curl -s https://api.github.com/repos/SpacingBat3/electron-discord-webapp/releases/latest \
| grep "browser_download_url.*arm64.deb" \
| cut -d : -f 2,3 \
| tr -d \" \
| wget -qi -
sudo apt -f -y install ./electron-discord-webapp_*_arm64.deb
